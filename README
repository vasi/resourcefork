Note: This is rather unfinished, but at least it mostly-works.
